$.extendIf=function(b,d){if(b&&d){for(var a in d){if(typeof b[a]=="undefined"){b[a]=d[a]}}}return b};if(typeof(Ext)=="undefined"){$.extend(Function.prototype,{createCallback:function(){var a=arguments;var b=this;return function(){return b.apply(window,a)}},createDelegate:function(c,b,a){var d=this;return function(){var f=b||arguments;if(a===true){f=Array.prototype.slice.call(arguments,0);f=f.concat(b)}else{if(typeof a=="number"){f=Array.prototype.slice.call(arguments,0);var e=[a,0].concat(b);Array.prototype.splice.apply(f,e)}}return d.apply(c||window,f)}},defer:function(c,e,b,a){var d=this.createDelegate(e,b,a);if(c){return setTimeout(d,c)}d();return 0},createSequence:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){var d=c.apply(this||window,arguments);b.apply(a||this||window,arguments);return d}},createInterceptor:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){b.target=this;b.method=c;if(b.apply(a||this||window,arguments)===false){return}return c.apply(this||window,arguments)}}});$.extendIf(String,{escape:function(a){return a.replace(/('|\\)/g,"\\$1")},leftPad:function(d,b,c){var a=new String(d);if(!c){c=" "}while(a.length<b){a=c+a}return a.toString()},format:function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})}})}String.prototype.isInteger=function(){return !isNaN(parseInt(this))};String.prototype.isFloat=function(){return !isNaN(parseFloat(this))};String.prototype.toggle=function(b,a){return this==b?a:b};String.prototype.trim=function(){var a=/^\s+|\s+$/g;return function(){return this.replace(a,"")}}();String.prototype.translate=function(d,c){if(!(d.length&&c.length)||d.length!=c.length){return this}var b=this;for(var a=0;a<d.length;a++){if(typeof(d)=="string"){b=b.replace(new RegExp(d.charAt(a),"g"),c.charAt(a))}else{b=b.replace(new RegExp(d[a],"g"),c[a])}}return b};String.prototype.isDigit=function(){return/^\d+$/.test(this)};String.prototype.removeWords=function(e){var d=this.split(" ");var c=new Array();for(var b=0;b<d.length;b++){c.push(d[b]);for(var a=0;a<e.length;a++){if(c[b]==e[a]){c.pop();break}}}return c.join(" ")};$.extendIf(Number.prototype,{constrain:function(b,a){return Math.min(Math.max(this,b),a)},isInteger:function(){return !isNaN(parseInt(this))},isFloat:function(){return !isNaN(parseFloat(this))}});$.extendIf(Array.prototype,{indexOf:function(c){for(var b=0,a=this.length;b<a;b++){if(this[b]==c){return b}}return -1},removeObject:function(b){var a=this.indexOf(b);if(a!=-1){this.splice(a,1)}return this},binarySearch:function binarySearch(f,b){var a=0,e=this.length-1,c,d;while(a<=e){c=parseInt((a+e)/2,10);d=b(this[c],f);if(d<0){a=c+1;continue}if(d>0){e=c-1;continue}return c}return -1},inject:function(c,b){for(var a=0;a<this.length;a++){c=b(c,this[a],a)}return c},map:function(d,c){var a=new Array(this.length);for(var b=0,e=this.length;b<e;b++){if(b in this){a[b]=d.call(c,this[b],b,this)}}return a},intersect:function(){if(!arguments.length){return[]}var e=this;var d=a2=null;var h=0;while(h<arguments.length){d=[];a2=arguments[h];var c=e.length;var b=a2.length;for(var g=0;g<c;g++){for(var f=0;f<b;f++){if(e[g]===a2[f]){d.push(e[g])}}}e=d;h++}return d.unique()},unique:function(){var c=[];var b=this.length;for(var e=0;e<b;e++){for(var d=e+1;d<b;d++){if(this[e]===this[d]){d=++e}}c.push(this[e])}return c}});Date.prototype.getElapsed=function(a){return Math.abs((a||new Date()).getTime()-this.getTime())};if(typeof(usig)=="undefined"){usig={}}usig.debug=function(a){if(window.console&&window.console.log){window.console.log(a)}};if(typeof(usig)=="undefined"){usig={}}$.extendIf(usig,{loadingJs:[],loadingJsListeners:{},__callLoadJsListeners:function(b){for(var c=0,a=usig.loadingJsListeners[b].length;c<a;c++){usig.loadingJsListeners[b][c]()}},loadJs:function(b,e){if(usig.loadingJs.indexOf(b)<0){usig.loadingJs.push(b);usig.loadingJsListeners[b]=(typeof(e)=="function")?[e]:[];var a=document.createElement("script"),c=document.getElementsByTagName("head")[0],d=false;a.onload=a.onreadystatechange=function(){if((a.readyState&&a.readyState!=="complete"&&a.readyState!=="loaded")||d){return false}a.onload=a.onreadystatechange=null;d=true;usig.__callLoadJsListeners(b)};a.src=b;c.insertBefore(a,c.firstChild)}else{usig.loadingJsListeners[b].push(e)}},loadCss:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);if(typeof b!="undefined"){document.getElementsByTagName("head")[0].appendChild(b)}},removeJs:function(a){var c=document.getElementsByTagName("script");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("src")!=null&&c[b].getAttribute("src").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},removeCss:function(a){var c=document.getElementsByTagName("link");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("href")!=null&&c[b].getAttribute("href").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},Animator:function(c,d,e,f){var b=0;function a(){if(c.length>b){d(c[b]);b++;setTimeout(a,e)}else{if(typeof(f)=="function"){f()}}}this.stop=function(){b=c.length+1};a()},parseUri:function(e){var a=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"],b=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?").exec(e),d={};for(var c=0;c<10;c++){d[a[c]]=(b[c]?b[c]:"")}if(d.directoryPath.length>0){d.directoryPath=d.directoryPath.replace(/\/?$/,"/")}return d},registeredSuggesters:{},registerSuggester:function(a,b){usig.registeredSuggesters[a]=b},createSuggester:function(b,a){if(typeof(usig.registeredSuggesters[b])!="function"){throw"Suggester "+b+" is not registered.";return null}return new usig.registeredSuggesters[b](a)}});if(typeof(usig)=="undefined"){usig={}}usig.MapaInteractivo=function(q,e){var r=$.extend({},usig.MapaInteractivo.defaults,e),D=$("#"+q),C=parseInt(D.css("width")),v=parseInt(D.css("height")),j={},c={},o={},y=null,g=false,z=false,u=this,p=null,x=[],a=$('<div class="indicator" style="-moz-border-radius-topleft: 10px; -webkit-border-top-left-radius: 10px; -moz-border-radius-topright: 10px; -webkit-border-top-right-radius: 10px; -moz-border-radius-bottomleft: 10px; -webkit-border-bottom-left-radius: 10px; -moz-border-radius-bottomright: 10px; -webkit-border-bottom-right-radius: 10px;"></div>'),E=navBar=panZoomBar=scalebar=overviewMap=statusBar=markersShadows=myMarkers=null;function B(){a.remove();r.OpenLayersOptions.maxExtent=new OpenLayers.Bounds(r.bounds[0],r.bounds[1],r.bounds[2],r.bounds[3]);r.OpenLayersOptions.initBounds=new OpenLayers.Bounds(r.initBounds[0],r.initBounds[1],r.initBounds[2],r.initBounds[3]);E=new OpenLayers.Map(q,r.OpenLayersOptions);this.api=E;this.api.zoomToMaxExtent=function(G){this.zoomToExtent(r.OpenLayersOptions.initBounds)};r.baseLayer=r.initLocation?"mapabsas_"+r.initLocation.map:r.baseLayer;this.setBaseLayer(r.baseLayer);E.zoomToExtent(r.OpenLayersOptions.initBounds);if(r.initLocation){E.moveTo(new OpenLayers.LonLat(r.initLocation.lon,r.initLocation.lat),r.initLocation.zl)}else{E.zoomToExtent(r.OpenLayersOptions.initBounds)}scalebar=new OpenLayers.Control.ScaleBar({minWidth:141,maxWidth:142});E.addControl(scalebar);if(r.includePanZoomBar){panZoomBar=new OpenLayers.Control.PanZoomBar({panner:true,zoomWorldIcon:true,textAcercar:r.texts.panZoomBar.textAcercar,textAlejar:r.texts.panZoomBar.textAlejar,verMapaCompleto:r.texts.panZoomBar.verMapaCompleto});E.addControl(panZoomBar);overviewMap=new OpenLayers.Control.OverviewMap({layers:[new OpenLayers.Layer.WMS("Referencia",m("referencia"),{layers:r.overviewOptions.layer})],size:new OpenLayers.Size(r.overviewOptions.size[0],r.overviewOptions.size[1]),minRatio:12,maxRatio:24,mapOptions:{projection:r.OpenLayersOptions.projection,units:r.OpenLayersOptions.units,maxExtent:r.OpenLayersOptions.maxExtent,resolutions:r.overviewOptions.resolutions}});E.addControl(overviewMap)}if(r.includeToolbar){navBar=new OpenLayers.Control.NavToolbar($.extend({},r.texts.navBar,{mapList:r.mapList,activeMap:r.baseLayer,mapSelectorText:r.texts.mapSelectorDefault,mapSelectorTrigger:(function(G){if(G!="none"){this.setBaseLayer(G)}else{this.setBaseLayer(r.baseLayer)}}).createDelegate(this),clickHandler:r.onMapClick,handleRightClicks:true,rightClickHandler:r.onMapClick}));E.addControl(navBar)}else{E.addControl(new OpenLayers.Control.Navigation())}statusBar=new OpenLayers.Control.StatusBar();E.addControl(statusBar);markersShadows=new OpenLayers.Layer.Vector("MarkersShadows",{styleMap:new OpenLayers.StyleMap({externalGraphic:r.rootUrl+"images/blank.gif",backgroundGraphic:r.rootUrl+"images/pincho_inclinado_shadow.png",graphicWidth:33,graphicHeight:10,graphicXOffset:-2,graphicYOffset:-29,backgroundXOffset:1,backgroundYOffset:-11,graphicZIndex:r.MARKER_Z_INDEX,backgroundGraphicZIndex:r.SHADOW_Z_INDEX,pointRadius:10}),rendererOptions:{yOrdering:true}});myMarkers=new OpenLayers.Layer.Markers("MyMarkers");E.addLayer(markersShadows);E.addLayer(myMarkers);if(typeof(r.onReady)=="function"){r.onReady(this)}if(r.trackVisits){var F=function(G){try{var I=Piwik.getTracker(r.piwikBaseUrl+"piwik.php",G);I.trackPageView();I.enableLinkTracking()}catch(H){}};if(typeof(Piwik)=="undefined"){usig.loadJs(r.piwikBaseUrl+"piwik.js",F.createDelegate(this,[r.piwikSiteId]))}else{F(r.piwikSiteId)}}}function k(){var F=usig.MapaInteractivo.defaults.OpenLayersJS.replace("OpenLayers.js","");$.each(r.preloadImages,function(H,G){x.push($('<img src="'+F+G+'"/>'))})}function m(F){var G=new Array();$.each(r.servers,function(H,I){G.push(I+F)});return G}this.setOptions=function(F){r=$.extend({},r,F)};this.updateSize=function(){E.updateSize.defer(200,E)};this.getMarkers=function(){return myMarkers};this.setBaseLayer=function(G){var F=E.baseLayer;if(F==undefined){var I=m(G);E.addLayer(new OpenLayers.Layer.WMS(G,I,{layers:G,format:"image/png"},{transitionEffect:"resize",buffer:0}))}else{if(F.name!=G){var I=m(G);try{E.removeLayer(F)}catch(H){}E.addLayer(new OpenLayers.Layer.WMS(G,I,{layers:G,format:"image/png"},{transitionEffect:"resize",buffer:0}))}}if(navBar){navBar.selectMap(G)}};function s(F){if(F instanceof OpenLayers.Marker){return F}var G=new OpenLayers.Size(20,36),J=new OpenLayers.Pixel(-5,-G.h),H=new OpenLayers.Icon(r.rootUrl+"images/pincho_inclinado.png",G,J),I=null;if(F.options){G=new OpenLayers.Size(F.options.iconWidth,F.options.iconHeight);H=new OpenLayers.Icon(F.options.iconUrl,G)}if(F.x!=undefined&&F.y!=undefined){I=new OpenLayers.LonLat(F.x,F.y)}if(usig.Direccion&&F instanceof usig.Direccion){I=new OpenLayers.LonLat(F.getCoordenadas().x,F.getCoordenadas().y)}if(usig.inventario&&usig.inventario.Objeto&&F instanceof usig.inventario.Objeto){I=new OpenLayers.LonLat(F.ubicacion.getCentroide().x,F.ubicacion.getCentroide().y)}H.imageDiv.className="Marker";return new OpenLayers.Marker(I,H)}function b(){if(usig.NormalizadorDirecciones){g=false;if(usig.NormalizadorDirecciones.listo()){d()}else{usig.NormalizadorDirecciones.init({onReady:b.createDelegate(this),loadFullDatabase:true})}}else{if(!g){g=true;usig.loadJs(r.NormalizadorDireccionesJS,b.createDelegate(this))}}}function d(){var F=0;if(usig.NormalizadorDirecciones&&usig.NormalizadorDirecciones.listo()){$.each(c,function(K,J){try{var I=J.place;var G=usig.NormalizadorDirecciones.normalizar(I,10);if(G.length>0){J.place=G[0];o[K]={place:J.place,goTo:J.goTo,onClick:J.onClick,options:J.options};F++}}catch(H){}delete c[K]});if(F>0){h()}}else{b()}}function h(){if(y){$.each(o,function(H,G){var F=G.place;y.geoCodificarDireccion(F,function(I){G.place.setCoordenadas(I);A(G.place,H,G.goTo,G.onClick,G.options)});delete o[H]})}else{n()}}function n(){if(usig.GeoCoder){z=false;y=new usig.GeoCoder();h()}else{if(!z){z=true;usig.loadJs(r.GeoCoderJS,n.createDelegate(this))}}}function t(F,G){if(G){if(E.getZoom()==r.goToZoomLevel){E.panTo(new OpenLayers.LonLat(F.lon,F.lat))}else{E.moveTo(new OpenLayers.LonLat(F.lon,F.lat),r.goToZoomLevel)}}else{E.panTo(new OpenLayers.LonLat(F.lon,F.lat))}}function A(K,G,H,M,N){var J={iconUrl:r.rootUrl+"images/pincho_inclinado.png",iconWidth:20,iconHeight:36,offsetX:-5,offsetY:-36};statusBar.activate(r.texts.processing,true);if(N){K.options=$.extend({},J,N)}else{if(typeof(M)=="object"){K.options=$.extend({},J,M)}}var L=s(K);var I=K;if(M&&typeof(M)!="function"&&typeof(M)!="object"){I=M}L.place=K;j[""+G]=L;myMarkers.addMarker(L);if(!(K instanceof OpenLayers.Marker)&&(typeof(N)!="object")&&typeof(M)!="object"){var F=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(L.lonlat.lon,L.lonlat.lat));L.shadow=F;markersShadows.addFeatures(F)}L.events.registerPriority("click",L,function(P){OpenLayers.Event.stop(P,false);var O=new OpenLayers.Popup.FramedCloud(G,L.lonlat,new OpenLayers.Size(10,10),I,L.icon,true,null);L.popup=O;O.hide();E.addPopup(O,true);if(typeof(M)=="function"){M(P,K,O)}else{O.show()}});statusBar.deactivate();if(H){t(L.lonlat,true)}return G}function w(I){var F=I.getPlan();var G=usig.GMLPlan.create("trip_plan_"+I.getId(),{template:I.getTemplate(),baseUrl:r.rootUrl});for(i=0;i<F.length;i++){var H=F[i];if(H.type!=undefined){if(H.type=="StartWalking"||H.type=="FinishWalking"){G.addMarker(H.gml)}else{if(H.type=="Board"){if(H.service_type=="1"){switch(H.service){case"Línea A":H.gml=H.gml.replace("subway","subwayA");break;case"Línea B":H.gml=H.gml.replace("subway","subwayB");break;case"Línea C":H.gml=H.gml.replace("subway","subwayC");break;case"Línea D":H.gml=H.gml.replace("subway","subwayD");break;case"Línea E":H.gml=H.gml.replace("subway","subwayE");break;case"Línea H":H.gml=H.gml.replace("subway","subwayH");break}}G.addMarker(H.gml)}else{if(H.type=="Bus"||H.type=="SubWay"||H.type=="Street"){G.addEdges([H.gml])}else{if(H.type=="SubWayConnection"){switch(H.service_to){case"Línea A":H.gml[1]=H.gml[1].replace("connection","subwayA");break;case"Línea B":H.gml[1]=H.gml[1].replace("connection","subwayB");break;case"Línea C":H.gml[1]=H.gml[1].replace("connection","subwayC");break;case"Línea D":H.gml[1]=H.gml[1].replace("connection","subwayD");break;case"Línea E":H.gml[1]=H.gml[1].replace("connection","subwayE");break;case"Línea H":H.gml[1]=H.gml[1].replace("connection","subwayH");break}G.addMarker(H.gml[1]);G.addEdges(H.gml)}}}}}}I.gmlLayer=G;return G}function f(H){var G=E.getLayersByName(H.gmlLayer.name);if(G.length>0){for(l=0;l<G.length;l++){G[l].setVisibility(true)}}else{var F=H.gmlLayer;E.addLayer(F)}E.zoomToExtent(H.gmlLayer.getDataExtent())}this.addMarker=function(F,I,J,G){var H=Math.floor(Math.random()*100001);var K=new Date()*1+H;if(typeof(F)=="string"){c[K]={place:F,goTo:I,onClick:J,options:G};d();return K}return A(F,K,I,J,G)};this.removeMarker=function(F){marker=j[""+F];if(marker.popup){E.removePopup(marker.popup);marker.popup.destroy()}myMarkers.removeMarker(marker);if(marker.shadow){markersShadows.removeFeatures(marker.shadow)}marker.destroy();marker=undefined;j[F]=undefined};this.toggleMarker=function(G,F){j[""+G].display(F);if(j[""+G].shadow){if(!F){markersShadows.removeFeatures(j[""+G].shadow)}else{markersShadows.addFeatures(j[""+G].shadow)}}};this.goTo=function(F,G){t(F,G)};this.showStatus=function(G,F){statusBar.activate(G,F)};this.hideStatus=function(){statusBar.deactivate()};this.raiseMarkers=function(F){E.raiseLayer(myMarkers,F)};this.getMarkersIndex=function(){return E.getLayerIndex(myMarkers)};this.getMarkersZIndex=function(){return myMarkers.getZIndex()};this.mostrarRecorrido=function(F){if(!F.gmlLayer){F.getPlan(function(){w(F);f(F)})}else{f(F)}};this.ocultarRecorrido=function(F){if(F.gmlLayer){F.gmlLayer.setVisibility(false)}};this.borrarRecorrido=function(F){if(F.gmlLayer){E.removeLayer(F.gmlLayer)}};if(typeof(OpenLayers)=="undefined"){p=$('<img src="'+r.rootUrl+'images/animated_indicator_medium.gif" alt="'+r.texts.loading+'"/>');p.css("padding","10px");a.css("background-color","#fff").css("width","52px").css("height","52px").css("border","1px solid #ddd").css("position","relative").css("left",(C/2-26)+"px").css("top",(v/2-26)+"px").append(p);D.css("background-color","#eee").append(a);usig.loadCss(r.OpenLayersCSS);usig.loadJs(r.OpenLayersJS,B.createDelegate(this));(function(){if(typeof(OpenLayers)=="undefined"){k()}}).defer(500,this)}else{B.defer(200,this)}};usig.MapaInteractivo.defaults={debug:false,trackVisits:true,includePanZoomBar:true,includeToolbar:true,bounds:[54340,54090,172855,140146],initBounds:[93500,96750,112000,106750],OpenLayersOptions:{controls:[],resolutions:[90,50,30,15,7.5,4,2,1,0.5,0.2],projection:"EPSG:221951",units:"m"},baseLayer:"mapabsas_default",rootUrl:"http://servicios.usig.buenosaires.gov.ar/usig-js/dev/",OpenLayersCSS:"http://servicios.usig.buenosaires.gov.ar/OpenLayers/2.9.1-6/theme/default/style.css",OpenLayersJS:"http://servicios.usig.buenosaires.gov.ar/OpenLayers/2.9.1-6/OpenLayers.js",NormalizadorDireccionesJS:"http://servicios.usig.buenosaires.gob.ar/nd-js/1.2/normalizadorDirecciones.min.js",GeoCoderJS:"http://servicios.usig.buenosaires.gob.ar/usig-js/2.2/usig.GeoCoder.min.js",piwikBaseUrl:"http://usig.buenosaires.gov.ar/piwik/",piwikSiteId:3,preloadImages:["img/panZoomBar/arriba.png","img/panZoomBar/izquierda.png","img/panZoomBar/abajo.png","img/panZoomBar/derecha.png","img/panZoomBar/centro.png","img/panZoomBar/bt_zoomin.gif","img/panZoomBar/bt_zoomout.gif","img/panZoomBar/bt_zoomworld.gif","img/panZoomBar/marcador_azul.gif","img/panZoomBar/zoomBar.png"],overviewOptions:{layer:"referencia",resolutions:[130,70,30,15,7.5,4],size:[195,130]},mapList:[{name:"mapabsas_imagen_satelital_2009",display:"Vista Satelital 2009",desc:"Mapa que incluye imagen satelital QuickBird, año de toma 2009. El mapa presenta la imagen satelital de alta resolución de la Ciudad de Buenos Aires con calles y alturas."},{name:"mapabsas_imagen_satelital_2004",display:"Vista Satelital 2004",desc:"Mapa que incluye imagen satelital QuickBird, año de toma 2004. El mapa presenta la imagen satelital de alta resolución de la Ciudad de Buenos Aires con calles y alturas."},{name:"mapabsas_fotografias_aereas_1978",display:"Vista Aérea 1978",desc:"Mapa que incluye una imagen de la ciudad restituida a partir de fotografías aéreas tomadas en el año 1978. El mapa presenta también la información de calles y alturas actuales como referencia."},{name:"mapabsas_fotografias_aereas_1965",display:"Vista Aérea 1965",desc:"Mapa que incluye una imagen de la ciudad restituida a partir de fotografías aéreas tomadas en el año 1965. El mapa presenta también la información de calles y alturas actuales como referencia."},{name:"mapabsas_fotografias_aereas_1940",display:"Vista Aérea 1940",desc:"Mapa que incluye una imagen de la ciudad restituida a partir de fotografías aéreas tomadas en el año 1940. El mapa presenta también la información de calles y alturas actuales como referencia."}],texts:{processing:"Procesando...",loading:"Cargando...",tituloMailing:"Enviar vista actual por e-mail",mapSelectorDefault:"Mapa",panZoomBar:{textAcercar:"Acercar",textAlejar:"Alejar",verMapaCompleto:"Ver el mapa completo"},overviewMap:{textMapaReferencia:"Mapa de referencia interactivo",textCerrar:"Cerrar"},navBar:{navigationText:"Mover",zoomBoxText:"Acercar",measureToolTexts:{buttonLabel:"Medir",measure:"Medida",measureDistance:"Medir Distancia",measureArea:"Medir Área"}}},goToZoomLevel:7,SHADOW_Z_INDEX:10,MARKER_Z_INDEX:11,servers:["http://tiles1.mapa.buenosaires.gob.ar/tilecache/","http://tiles2.mapa.buenosaires.gob.ar/tilecache/","http://tiles3.mapa.buenosaires.gob.ar/tilecache/","http://tiles4.mapa.buenosaires.gob.ar/tilecache/","http://tiles5.mapa.buenosaires.gob.ar/tilecache/","http://tiles6.mapa.buenosaires.gob.ar/tilecache/","http://tiles7.mapa.buenosaires.gob.ar/tilecache/"]};if(typeof(usig)=="undefined"){usig={}}usig.GMLPlan=(function(){var a;return{create:function(c,b){if(!OpenLayers){throw ("ERROR: OpenLayers is not loaded.");return null}if(!a){a=OpenLayers.Class(OpenLayers.Layer.Vector,{format:null,formatOptions:null,loaded:false,edges:null,markers:null,styleMap:null,initialize:function(f,e){var d=[];this.styleMap=this.getStyle(e.template,e.baseUrl);d.push(f,{styleMap:this.styleMap});OpenLayers.Layer.Vector.prototype.initialize.apply(this,d);this.edges=new Array();this.markers=new Array()},loadFeatures:function(){var d={};OpenLayers.Util.extend(d,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){d.externalProjection=this.projection;d.internalProjection=this.map.getProjectionObject()}var e=this.format?new this.format(d):new OpenLayers.Format.GML(d);gml='<?xml version="1.0" encoding="utf-8"?><wfs:FeatureCollection xmlns:ms="http://mapserver.gis.umn.edu/mapserver" xmlns:wfs="http://www.opengis.net/wfs" xmlns:gml="http://www.opengis.net/gml">';gml+=this.edges.join();gml+=this.markers.join();gml+="</wfs:FeatureCollection>";this.loaded=true;this.addFeatures(e.read(gml));this.events.triggerEvent("loadend")},addMarker:function(d){this.markers.push("<gml:featureMember>"+d+"</gml:featureMember>")},addEdges:function(d){ls=this.edges;$.each(d,function(f,e){ls.push("<gml:featureMember>"+e+"</gml:featureMember>")})},setVisibility:function(d,e){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments);if(this.visibility&&!this.loaded){this.events.triggerEvent("loadstart");this.loadFeatures()}},moveTo:function(f,d,e){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.events.triggerEvent("loadstart");this.loadFeatures()}},getFeatureByAttrId:function(g){var f=null;for(var e=0,d=this.features.length;e<d;++e){if(this.features[e].attributes.fid==g){f=this.features[e];break}}return f},highlightFeature:function(d){this.drawFeature(d,this.styleMap.styles.select)},getStyle:function(d,e){defaultOpacity=0.8;lineOptions={strokeWidth:6,strokeOpacity:defaultOpacity};lineOptionsWalk={strokeWidth:4,strokeDashstyle:"dashdot",strokeOpacity:defaultOpacity};if(d.marker!=undefined){externalGraphic=e+"images/"+d.marker}else{externalGraphic=e+"images/pincho_inclinado.png"}color=d.color;styleMap=new OpenLayers.StyleMap(OpenLayers.Util.applyDefaults({fillColor:color,fillOpacity:1,strokeColor:color,strokeWidth:3,strokeOpacity:1},OpenLayers.Feature.Vector.style["default"]));var f={walk:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/recorrido_pie.png",graphicZIndex:5},Line:lineOptionsWalk},bus:{Point:{pointRadius:12,externalGraphic:e+"images/recorrido_colectivo.png",graphicWidth:35,graphicHeight:35,graphicZIndex:5},Line:lineOptions},car:{Point:{externalGraphic:e+"images/recorrido_auto.png",graphicWidth:35,graphicHeight:35,graphicZIndex:5},Line:lineOptions},subway:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/recorrido_subte.png",graphicZIndex:5},Line:lineOptions},subwayA:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/lineasubte41x41-a.png",graphicZIndex:5},Line:lineOptions},subwayB:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/lineasubte41x41-b.png",graphicZIndex:5},Line:lineOptions},subwayC:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/lineasubte41x41-c.png",graphicZIndex:5},Line:lineOptions},subwayD:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/lineasubte41x41-d.png",graphicZIndex:5},Line:lineOptions},subwayE:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/lineasubte41x41-e.png",graphicZIndex:5},Line:lineOptions},subwayH:{Point:{pointRadius:12,graphicWidth:35,graphicHeight:35,externalGraphic:e+"images/lineasubte41x41-h.png",graphicZIndex:5},Line:lineOptions},connection:{Point:{pointRadius:6},Line:{strokeWidth:8,strokeOpacity:defaultOpacity}},train:{Point:{pointRadius:12,externalGraphic:e+"images/recorrido_tren.png",graphicWidth:35,graphicHeight:35},graphicZIndex:5,Line:lineOptions},marker:{Point:{externalGraphic:externalGraphic,graphicYOffset:-20,graphicWidth:20,graphicHeight:36},graphicZIndex:5,Line:lineOptions}};styleMap.addUniqueValueRules("default","type",f);return styleMap},CLASS_NAME:"usig.GMLPlan"})}return new a(c,b)}}})();